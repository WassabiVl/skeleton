import e from"lodash";import{ref as t,onMounted as a,inject as r,toRefs as n,computed as l,getCurrentInstance as o,watch as i,provide as u,onBeforeMount as s,onBeforeUnmount as c,reactive as v,onBeforeUpdate as p,onUpdated as f,onUnmounted as d}from"vue";import"moment";function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){b(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e,t,a,r,n,l,o){try{var i=e[l](o),u=i.value}catch(e){return void a(e)}i.done?t(u):Promise.resolve(u).then(r,n)}function g(e){return function(){var t=this,a=arguments;return new Promise((function(r,n){var l=e.apply(t,a);function o(e){y(l,r,n,o,i,"next",e)}function i(e){y(l,r,n,o,i,"throw",e)}o(void 0)}))}}function b(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}!function(e){var t=function(e){var t,a=Object.prototype,r=a.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},l="function"==typeof Symbol?Symbol:{},o=l.iterator||"@@iterator",i=l.asyncIterator||"@@asyncIterator",u=l.toStringTag||"@@toStringTag";function s(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,a){return e[t]=a}}function c(e,t,a,r){var l=t&&t.prototype instanceof m?t:m,o=Object.create(l.prototype),i=new S(r||[]);return n(o,"_invoke",{value:x(e,a,i)}),o}function v(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p="suspendedStart",f="executing",d="completed",h={};function m(){}function y(){}function g(){}var b={};s(b,o,(function(){return this}));var C=Object.getPrototypeOf,O=C&&C(C(E([])));O&&O!==a&&r.call(O,o)&&(b=O);var j=g.prototype=m.prototype=Object.create(b);function w(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function $(e,t){function a(n,l,o,i){var u=v(e[n],e,l);if("throw"!==u.type){var s=u.arg,c=s.value;return c&&"object"==typeof c&&r.call(c,"__await")?t.resolve(c.__await).then((function(e){a("next",e,o,i)}),(function(e){a("throw",e,o,i)})):t.resolve(c).then((function(e){s.value=e,o(s)}),(function(e){return a("throw",e,o,i)}))}i(u.arg)}var l;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){a(e,r,t,n)}))}return l=l?l.then(n,n):n()}})}function x(e,t,a){var r=p;return function(n,l){if(r===f)throw new Error("Generator is already running");if(r===d){if("throw"===n)throw l;return L()}for(a.method=n,a.arg=l;;){var o=a.delegate;if(o){var i=A(o,a);if(i){if(i===h)continue;return i}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===p)throw r=d,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=f;var u=v(e,t,a);if("normal"===u.type){if(r=a.done?d:"suspendedYield",u.arg===h)continue;return{value:u.arg,done:a.done}}"throw"===u.type&&(r=d,a.method="throw",a.arg=u.arg)}}}function A(e,a){var r=a.method,n=e.iterator[r];if(n===t)return a.delegate=null,"throw"===r&&e.iterator.return&&(a.method="return",a.arg=t,A(e,a),"throw"===a.method)||"return"!==r&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var l=v(n,e.iterator,a.arg);if("throw"===l.type)return a.method="throw",a.arg=l.arg,a.delegate=null,h;var o=l.arg;return o?o.done?(a[e.resultName]=o.value,a.next=e.nextLoc,"return"!==a.method&&(a.method="next",a.arg=t),a.delegate=null,h):o:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,h)}function q(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(q,this),this.reset(!0)}function E(e){if(e){var a=e[o];if(a)return a.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,l=function a(){for(;++n<e.length;)if(r.call(e,n))return a.value=e[n],a.done=!1,a;return a.value=t,a.done=!0,a};return l.next=l}}return{next:L}}function L(){return{value:t,done:!0}}return y.prototype=g,n(j,"constructor",{value:g,configurable:!0}),n(g,"constructor",{value:y,configurable:!0}),y.displayName=s(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,u,"GeneratorFunction")),e.prototype=Object.create(j),e},e.awrap=function(e){return{__await:e}},w($.prototype),s($.prototype,i,(function(){return this})),e.AsyncIterator=$,e.async=function(t,a,r,n,l){void 0===l&&(l=Promise);var o=new $(c(t,a,r,n),l);return e.isGeneratorFunction(a)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(j),s(j,u,"Generator"),s(j,o,(function(){return this})),s(j,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var r in t)a.push(r);return a.reverse(),function e(){for(;a.length;){var r=a.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=E,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var a in this)"t"===a.charAt(0)&&r.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var a=this;function n(r,n){return i.type="throw",i.arg=e,a.next=r,n&&(a.method="next",a.arg=t),!!n}for(var l=this.tryEntries.length-1;l>=0;--l){var o=this.tryEntries[l],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),s=r.call(o,"finallyLoc");if(u&&s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var l=n;break}}l&&("break"===e||"continue"===e)&&l.tryLoc<=t&&t<=l.finallyLoc&&(l=null);var o=l?l.completion:{};return o.type=e,o.arg=t,l?(this.method="next",this.next=l.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),P(a),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var r=a.completion;if("throw"===r.type){var n=r.arg;P(a)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,a,r){return this.delegate={iterator:E(e),resultName:a,nextLoc:r},"next"===this.method&&(this.arg=t),h}},e}({});try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}();var C=function(t,r){var n=function(t,a,r){var n=r.deps||{};return r=m(m({},r),{},{events:a.emits,slots:a.slots}),a.features.forEach((l=>{e.each(l(t,a,n,r),((e,t)=>{n[t]=e}))})),n}(t,r,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{});return a((()=>{n.initWatcher&&n.initWatcher(),n.initMessageBag&&n.initMessageBag(),n.initValidation&&n.initValidation()})),m({},n)},O=function(e,t,a){return{form$:r("form$")}},j=function(e,t,a){return{theme:r("theme")}},w=function(e,t,a){var{layout:r,inline:o}=n(e);return{elementLayout:l((()=>o.value||!r.value?"ElementLayoutInline":r.value))}},$=function(e,t,a){var{name:r}=n(e),i=o(),{form$:u}=a,s=l((()=>{var e=(e,t)=>e&&(3===u.value.$vueform.vueVersion&&e.$options.name&&e.$options.name.match(/^[a-zA-Z\-]*Element$/)||2===u.value.$vueform.vueVersion&&e.hasOwnProperty("el$")&&"function"!=typeof e.el$)?e.el$:e.$parent?t(e.$parent,t):null;return e(3===u.value.$vueform.vueVersion?i.parent.proxy:i.proxy.$parent,e)})),c=l((()=>s.value&&s.value.path?s.value.path+"."+r.value:r.value)),v=l((()=>s.value&&s.value.dataPath?s.value.dataPath+"."+r.value:r.value)),p=l((()=>!1));return{parent:s,path:c,dataPath:v,flat:p}},x=function(a,r,o){var{parent:i,conditions:u}=n(a),s=o.form$,c=o.path||t(null),v=o.el$||t(void 0),p=t(u.value),f=t({}),d=l((()=>!(s.value.conditions&&(i&&i.value&&void 0!==i.value.available&&!i.value.available||p.value&&p.value.length&&e.some(p.value,(e=>!s.value.$vueform.services.condition.check(e,c.value,s.value,v.value))))))),h=()=>{p.value=Object.values(f.value).reduce(((e,t)=>e.concat(t)),u.value)};return{conditionList:p,available:d,additionalConditions:f,updateConditions:h,addConditions:(e,t)=>{f.value[e]=t,h()},removeConditions:e=>{delete f.value[e],h()}}},A=function(a,r,o){var u,s,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{name:v,type:p}=n(a),f=o.parent,d=o.defaultValue,h=o.dataPath,m=o.form$,y=t(void 0);m.value.isSync?y.value=e.get(m.value.model,h.value):f.value&&-1!==["group","object","list","multifile"].indexOf(f.value.type)&&(y.value=f.value.value[v.value]);var g=t(d.value instanceof File?d.value:e.cloneDeep(d.value)),b=l({get:(null===(u=c.value)||void 0===u?void 0:u.get)||function(){var t;return void 0!==(t=m.value.isSync?e.get(m.value.model,h.value):f.value&&-1!==["group","object","list","multifile"].indexOf(f.value.type)?f.value.value[v.value]:g.value)?t:d.value instanceof File?d.value:e.cloneDeep(d.value)},set:(null===(s=c.value)||void 0===s?void 0:s.set)||function(e){if(m.value.isSync)m.value.updateModel(h.value,e);else if(f.value&&-1!==["list","multifile"].indexOf(f.value.type)){var t=f.value.value.map(((t,a)=>a==v.value?e:t));f.value.update(t)}else f.value&&-1!==["group","object"].indexOf(f.value.type)?f.value.value=Object.assign({},f.value.value,{[v.value]:e}):g.value=e}}),C=l({get:()=>b.value,set(e){b.value=e}});return void 0!==c.init&&!1===c.init||void 0===y.value&&(b.value=d.value instanceof File?d.value:e.cloneDeep(d.value)),i(p,(()=>{b.value=d.value instanceof File?d.value:e.cloneDeep(d.value)})),{initialValue:y,internalValue:g,value:b,model:C}},q=function(t,a,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{submit:i,formatData:u,formatLoad:s,name:c}=n(t),v=r.form$,p=r.available,f=r.value,d=r.resetValidators,h=r.defaultValue,m=r.nullValue,y=e=>{if(o.setValue)return o.setValue(e);f.value=e},b=l((()=>({[c.value]:f.value}))),C=l((()=>p.value&&i.value?u.value?u.value(c.value,f.value,v.value):{[c.value]:f.value}:{})),O=function(){var e=g((function*(){}));return function(){return e.apply(this,arguments)}}();return{data:b,requestData:C,load:function(e){y(arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&s.value?s.value(e,v.value):e)},update:e=>{y(e)},clear:()=>{y(e.cloneDeep(m.value))},reset:()=>{y(e.cloneDeep(h.value)),d()},prepare:O}};function P(e,t,a){var r=a.locale||t.i18n.locale;return r&&e&&"object"==typeof e?(null==e?void 0:e[r])||(null==e?void 0:e[r.toUpperCase()])||(null==e?void 0:e[t.i18n.fallbackLocale])||(null==e?void 0:e[t.i18n.fallbackLocale.toUpperCase()])||(null==e?void 0:e[Object.keys(e)[0]])||"":e}var S=function(t,a,r){var{default:o,name:i}=n(t),u=r.nullValue,s=r.form$,c=r.parent;return{defaultValue:l((()=>{var t;return c&&c.value&&!c.value.mounted?t=c.value.defaultValue[i.value]:!s.value.mounted&&s.value.options.default[i.value]&&(t=s.value.options.default[i.value]),void 0!==t?t instanceof File?new File([t],t.name,t):e.cloneDeep(t):void 0!==o.value?o.value instanceof File?new File([o.value],o.value.name,o.value):e.cloneDeep(o.value):e.cloneDeep(u.value)}))}},{hasOwnProperty:E,toString:L}=Object.prototype;function F(e){return"string"==typeof e&&e.trim().length>0}function V(t){return e.isPlainObject(t)&&(F(t.template)||function(e){return"function"==typeof e}(t.render)||F(t.el)||function(e){return function(e){return!!e}(e)&&1===e.nodeType&&L.call(e).indexOf("Element")>-1}(t.el)||V(t.extends)||function(e){return Array.isArray(e)&&e.length>0}(t.mixins)&&t.mixins.some((e=>V(e))))||"function"==typeof t&&t.prototype&&"VueComponent"===t.prototype.constructor.name}var D=function(e,t,a){var{label:o}=n(e),i=a.form$,u=a.el$,s=r("config$"),c=l((()=>{var e,t;return!!(i.value.options.forceLabels||o.value||u.value.slots.label||null!==(e=u.value.$slots)&&void 0!==e&&e.label||2===i.value.$vueform.vueVersion&&null!==(t=u.value.$scopedSlots)&&void 0!==t&&t.label)})),v=l((()=>"function"==typeof o.value&&(!o.value.prototype||!o.value.prototype.constructor||o.value.prototype.constructor&&"VueComponent"!==o.value.prototype.constructor.name))),p=l((()=>V(o.value)));return{hasLabel:c,Label:l((()=>{var e=v.value?o.value(u.value):o.value||null;return p.value||(e=P(e,s.value,i.value)),e}))}},k=function(a,r,o){var{columns:u,presets:s}=n(a),c=o.form$,v=o.theme,p=o.hasLabel,f=t(e.cloneDeep(u.value)),d=l((()=>{var e=c.value.$vueform.config;return new c.value.$vueform.services.columns({configPresetColumns:e.usePresets,configColumns:e.columns,formPresetColumns:c.value.options.presets,formColumns:c.value.options.columns,elementPresetColumns:s.value,elementColumns:f.value},p.value,v.value.columns,e.presets)})),h=l((()=>d.value.classes)),m=l((()=>d.value.cols));return i(u,(t=>{f.value=e.cloneDeep(t)}),{immediate:!1,deep:!0}),{cols:m,columnsClassesService:d,columnsClasses:h,updateColumns:t=>{f.value=e.cloneDeep(t)}}},T=function(e){return void 0===e||"string"!=typeof e?e:e.match(/^-*\d+$/)?parseInt(e,10):e.match(/^\d+\.\d+$/)?parseFloat(e):e},_=function(r,i,v){var h={onBeforeMount:s,onMounted:a,onBeforeUpdate:p,onUpdated:f,onBeforeUnmount:c,onUnmounted:d},m=o(),y=v.form$,g=v.fire,{assignToParent:b,removeFromParent:C}=function(e,t,a){var{name:r}=n(e),l=o(),i=a.form$;return{assignToParent:(e,t)=>{e.children$Array?e.children$Array.push(l.proxy):e.elements$?i.value.$set(e.elements$,r.value,l.proxy):t(e.$parent,t)},removeFromParent:(e,t)=>{e.children$Array?e.children$Array.splice(e.children$Array.map((e=>T(e.name))).indexOf(T(r.value)),1):e.elements$?i.value.$delete(e.elements$,r.value):t(e.$parent,t)}}}(r,0,{form$:y}),O=t(null),j=t(!1),w=t(!0),$=l((()=>!1)),x=l((()=>!1)),A=l((()=>!1)),q=l((()=>!1)),P=l((()=>w.value)),S=l((()=>m.proxy));return u("el$",S),s((()=>{b(m.proxy.$parent,b)})),a((()=>{j.value=!0})),c((()=>{C(m.proxy.$parent,C)})),Object.values(["onBeforeCreate","onCreated"]).forEach((t=>{g(e.lowerFirst(t.replace("on","")),S.value)})),Object.keys(h).forEach((t=>{h[t]((()=>{g(e.lowerFirst(t.replace("on","")),S.value)}))})),{el$:S,isStatic:$,isFileType:x,isArrayType:q,isImageType:A,isActive:P,active:w,mounted:j,container:O,activate:()=>{w.value=!0},deactivate:()=>{w.value=!1}}},z=function(t,a,o){var{name:i,floating:u,placeholder:s,label:c,fieldName:v}=n(t),p=o.form$,f=o.Label,d=r("config$");return{genericName:l((()=>v&&v.value?P(v.value,d.value,p.value):c&&c.value?f.value:u&&u.value?P(u.value,d.value,p.value):s&&s.value&&p.value.options.floatPlaceholders?P(s.value,d.value,p.value):e.upperFirst(i.value).replace(/_|-/g," ")))}},B=function(a,r,o){var{size:i,view:s,views:c,presets:v}=n(a),p=r.name,f=o.available,d=o.active,h=o.form$,m=o.parent,y=t(!1),g=l((()=>f.value&&!y.value&&d.value)),b=l((()=>{var t;return i.value?t=i.value:e.each(v.value,(e=>{var a=h.value.$vueform.config.presets[e];a&&a.size&&(t=a.size)})),t||(t=m.value?m.value.Size:h.value.Size),t})),C=l((()=>s.value?s.value:O.value[p.value])),O=l((()=>{var t=h.value.Views;return e.each(v.value,(e=>{var a=h.value.$vueform.config.presets[e];a&&a.views&&(t=Object.assign({},t,a.views))})),t=Object.assign({},t,c.value)}));return u("Size",b),u("View",C),u("Views",O),{hidden:y,visible:g,Size:b,View:C,Views:O,hide:()=>{y.value=!0},show:()=>{y.value=!1}}},N=function(t,a,r){var{templates:o,presets:i}=n(t),u=a.name,s=r.theme,c=r.View,v=r.form$,p=l((()=>{var t={};return e.each(i?i.value:[],(e=>{var a=v.value.$vueform.config.presets[e];a&&a.templates&&(t=Object.assign({},t,a.templates))})),m(m(m({},s.value.templates),t),o?o.value:{})})),f=l((()=>c&&c.value&&p.value["".concat(u.value,"_").concat(c.value)]?p.value["".concat(u.value,"_").concat(c.value)]:p.value[u.value]));return{Templates:p,template:f}},M=function(t,a,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n(t);var i=r.el$,u=["label","info","description","before","between","after"],s=["checkbox","radio","option","single-label","multiple-label","tag","no-results","no-options","after-list","before-list","placeholder","group-label","caret","clear","spinner","option","default"];return{elementSlots:l((()=>{var t={};return u.filter((e=>-1!==o.slots.indexOf(e))).forEach((a=>{var r=i.value.slots[a]||i.value.slots[e.camelCase(a)];"object"==typeof r&&(r.props&&(Array.isArray(r.props)&&-1===r.props.indexOf("el$")||!Array.isArray(r.props)&&-1===Object.keys(r.props).indexOf("el$"))?Array.isArray(r.props)?r.props.push("el$"):r.props.el$={type:Object,required:!0}:r.props||(r.props=["el$"])),t[a]=r})),t})),fieldSlots:l((()=>{var t={};return s.filter((e=>-1!==o.slots.indexOf(e))).forEach((a=>{var r=i.value.slots[a]||i.value.slots[e.camelCase(a)];"object"==typeof r&&(r.props&&(Array.isArray(r.props)&&-1===r.props.indexOf("el$")||!Array.isArray(r.props)&&-1===Object.keys(r.props).indexOf("el$"))?Array.isArray(r.props)?r.props.push("el$"):r.props.el$={type:Object,required:!0}:r.props||(r.props=["el$"])),t[a]=r})),t}))}},U=function(e,a,r){var{disabled:o}=n(e),i=t(null),u=l((()=>o.value&&!1!==i.value||!0===i.value));return{localDisabled:i,isDisabled:u,disable:()=>{i.value=!0},enable:()=>{i.value=!1}}},I=function(a,r,n){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!l.events)throw new Error("`events` option is required for useEvents");var o=t(l.events),i=t({}),u=(e,t)=>{i.value[e]||(i.value[e]=[]),i.value[e].push(t)};return e.each(o.value,(t=>{var r=a["on"+e.upperFirst(e.camelCase(t))];r&&u(t,r)})),{events:o,listeners:i,on:u,off:e=>{delete i.value[e]},fire:function(){var t=arguments[0],a=[].slice.call(arguments).splice(1);e.each(i.value[t],(e=>{e(...a)})),i.value[t]&&i.value[t].length||r.emit(...[t].concat(a))}}},G=function(e,t,a){var r=a.model;return{handleInput:e=>{r.value=e.target.value}}},R=function(t,a,r){var n=r.value,o=r.nullValue;return{empty:l((()=>e.isEqual(n.value,o.value)||-1!==[void 0,null,""].indexOf(n.value)))}},H=function(e,t,a){var{floating:r,placeholder:o}=n(e),i=a.form$;return{hasFloating:l((()=>!!(r.value||o.value&&i.value.options.floatPlaceholders)&&!1!==r.value))}},W=["presets","usePresets","addClasses","prependClasses","removeClasses","replaceClasses","overrideClasses"],Y=["addClass","removeClass","replaceClass","overrideClass"];class Z{constructor(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t,this.shouldMergeTemplateClasses?(this.componentClasses=this.templateClasses,this.merge({overrideClasses:{[this.component]:this.themeClasses}})):this.componentClasses=this.templateClasses,this.merge(this.config),e.each(t.merge,(e=>{this.merge(e)})),this.merge(this.locals||this.component$.value,!0),this.config.classHelpers&&"production"!==this.config.env&&this.merge({prependClasses:{[this.component]:this.getClassHelpers(this.componentClasses,[this.component])}})}get classes(){return new Proxy(this.componentClasses,{get:(e,t)=>"string"!=typeof t?e[t]:this.getDynamicClasses(e,t)})}get config(){return this.options.config||{}}get component(){return this.options.component}get component$(){return this.options.component$}get locals(){return this.options.locals}get view(){return this.options.view}get theme(){return this.options.theme}get presets(){return this.config.presets}get templates(){return this.options.templates||{}}get template(){return this.view&&this.templates["".concat(this.component,"_").concat(this.view)]?this.templates["".concat(this.component,"_").concat(this.view)]:this.templates[this.component]||{}}get themeClasses(){return e.cloneDeep(this.toArray(this.view&&this.theme.classes["".concat(this.component,"_").concat(this.view)]?this.theme.classes["".concat(this.component,"_").concat(this.view)]:this.theme.classes[this.component]))}get templateClasses(){return e.cloneDeep(this.toArray(this.defaultClasses))}get shouldMergeTemplateClasses(){var e="function"==typeof this.template.data&&void 0!==this.template.data().merge?this.template.data().merge:this.component$.value.merge;return void 0!==e&&e}get defaultClasses(){return"function"==typeof this.template.data&&this.template.data().defaultClasses?this.template.data().defaultClasses:this.component$.value.defaultClasses}get mainClass(){var e="function"==typeof this.template.data&&this.template.data().defaultClasses?this.template.data().defaultClasses:this.component$.value.defaultClasses;return Object.keys(e)[0]}merge(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.each(this.pick(t,a?Y:W),((t,a)=>{switch(a){case"addClasses":case"prependClasses":case"overrideClasses":if(!t||void 0===t[this.component])return;this.mergeComponentClasses(this.toArray(t[this.component]),a);break;case"removeClasses":case"replaceClasses":if(!t||void 0===t[this.component])return;this.mergeComponentClasses(t[this.component],a);break;case"addClass":case"removeClass":case"replaceClass":case"overrideClass":if(!t)return;"string"==typeof t||Array.isArray(t)?(Array.isArray(t)||(t=t.length>0?t.split(" "):[]),this.mergeComponentClasses({[this.mainClass]:t},"".concat(a,"es"))):"replaceClass"===a?this.mergeComponentClasses(t,"".concat(a,"es")):e.isPlainObject(t)&&this.mergeComponentClasses(this.toArray(t),"".concat(a,"es"));break;case"presets":case"usePresets":if(!Array.isArray(t))return;e.each(t,(e=>{this.merge(this.presets[e])}))}}))}mergeComponentClasses(t,a){e.each(t,((e,t)=>{this[a](e,[t])}))}addClasses(t,a){var r=e.get(this.componentClasses,a.join("."));(1!=t.length||t[0])&&(e.isPlainObject(r)?e.each(t,((e,t)=>{this.addClasses(e,a.concat(t))})):e.set(this.componentClasses,a.join("."),e.union(r,t)))}prependClasses(t,a){var r=e.get(this.componentClasses,a.join("."));(1!=t.length||t[0])&&(e.isPlainObject(r)?e.each(t,((e,t)=>{this.prependClasses(e,a.concat(t))})):e.set(this.componentClasses,a.join("."),e.union(t,r)))}removeClasses(t,a){var r=e.get(this.componentClasses,a.join("."));e.isPlainObject(r)?e.each(t,((e,t)=>{this.removeClasses(e,a.concat(t))})):Array.isArray(r)&&e.set(this.componentClasses,a.join("."),r.filter((e=>"string"!=typeof e||-1===t.indexOf(e))))}replaceClasses(t,a){var r=e.get(this.componentClasses,a.join("."));if(Array.isArray(t)){var n={};t.forEach((e=>{n=m(m({},n),e)})),t=n}e.isPlainObject(r)?e.each(t,((e,t)=>{this.replaceClasses(e,a.concat(t))})):Array.isArray(r)&&e.set(this.componentClasses,a.join("."),r.map((e=>"string"!=typeof e||-1===Object.keys(t).indexOf(e)?e:t[e])))}overrideClasses(t,a){var r=e.get(this.componentClasses,a.join("."));e.isPlainObject(r)?e.each(t,((e,t)=>{this.overrideClasses(e,a.concat(t))})):e.set(this.componentClasses,a.join("."),t)}toArray(t){var a={};return e.each(t,((e,t)=>{a[t]=this.classesToArray(e,[t])})),a}classesToArray(t,a){var r,n=t,l=a?e.get(this.componentClasses,a.join(".")):void 0;if("string"==typeof t)n=t.length>0?t.split(" "):[];else if(e.isPlainObject(t))l&&Array.isArray(l)?n=[t]:l&&!e.isPlainObject(l)||(n={},e.each(t,((e,t)=>{n[t]=this.classesToArray(e,a.concat([t]))})));else if("boolean"==typeof t||"object"==typeof t&&-1!==["ComputedRefImpl","RefImpl"].indexOf(null==t||null===(r=t.constructor)||void 0===r?void 0:r.name))throw Error("Cannot add conditional class to ".concat(this.component,": '").concat(a.join("."),"'"));return n}getDynamicClasses(t,a,r){r||(r=t);var n=Array.isArray(t[a])?e.flattenDeep(t[a]):t[a];return t["$".concat(a)]?e.flattenDeep(t["$".concat(a)](r,this.component$.value)):(e.isPlainObject(n)&&(n=e.cloneDeep(n),e.each(n,((e,a)=>{n[a]=this.getDynamicClasses(n,a,t)}))),n)}getClassHelpers(t,a){var r={};return e.each(t,((n,l)=>{l.match(/[$]/)||(e.isPlainObject(n)?r[l]=this.getClassHelpers(t[l],a.concat([l])):r[l]=["".concat(a.join("."),".").concat(l,"--\x3e")])})),r}pick(t,a){var r={};return t?(e.each(a,(e=>{e in t&&(r[e]=t[e])})),r):r}}var J=function(e,t,a){var r=t.name,n=a.form$,o=a.el$,i=a.theme,u=a.Templates,s=a.View,c=l((()=>new Z({component:r.value,component$:o,theme:i.value,config:n.value.$vueform.config,templates:u.value,view:s.value,merge:[n.value.options,o.value]})));return{classes:l((()=>{var e;return m({},null===(e=c.value)||void 0===e?void 0:e.classes)})),classesInstance:c}},K=function(e,t,a){var{id:r}=n(e),o=a.path;return{fieldId:l((()=>r.value||o.value))}},Q=function(e,a,r){return{input:t(null)}};function X(){return(X=g((function*(t,a){for(var r=0;r<(e.isPlainObject(t)?e.values(t):t).length;r++){var n=e.isPlainObject(t)?e.keys(t)[r]:r;yield a(t[n],n,t)}}))).apply(this,arguments)}var ee=function(a,r,o){var{rules:i}=n(a),u=o.form$,s=o.path,c=t({dirty:!1,validated:!0}),p=t([]),f=t({}),d=v({}),h=l((()=>i.value)),m=l((()=>c.value.dirty)),y=l((()=>c.value.validated)),b=l((()=>e.some(p.value,{invalid:!0}))),C=l((()=>e.some(p.value,{pending:!0}))),O=l((()=>C.value)),j=l((()=>{var t=[];return e.each(p.value,(e=>{e.failing&&t.push(e.message)})),t})),w=l((()=>f.value.errors)),$=l((()=>f.value.error||null)),x=l((()=>null!==$.value)),A=l((()=>h.value&&h.value.length>0&&c.value.validated&&!b.value||(!h.value||!h.value.length)&&m.value)),q=function(){var e=g((function*(){h.value&&!1!==u.value.validation&&(yield function(e,t){return X.apply(this,arguments)}(p.value,function(){var e=g((function*(e){yield e.validate()}));return function(t){return e.apply(this,arguments)}}()),c.value.validated=!0)}));return function(){return e.apply(this,arguments)}}(),P=()=>{h.value&&(c.value.validated=!1,d.value=new u.value.$vueform.services.validation.factory(s.value,u.value),p.value=[],e.each(d.value.makeAll(h.value),(e=>{p.value.push(e)})))};return{state:c,Validators:p,messageBag:f,dirty:m,validated:y,invalid:b,pending:C,busy:O,errors:w,error:$,validationRules:h,isDanger:x,isSuccess:A,validate:q,dirt:()=>{c.value.dirty=!0},clean:()=>{c.value.dirty=!1},clearMessages:()=>{f.value&&f.value.clear()},resetValidators:()=>{e.each(p.value,(e=>{e.reset()})),c.value.validated=!h.value},initMessageBag:()=>{f.value=new u.value.$vueform.services.messageBag(j)},initValidation:P,reinitValidation:()=>{P()}}},te=function(e,r,n){var l=n.input,o=t(!1);return a((()=>{l&&l.value&&l.value.addEventListener&&(l.value.addEventListener("focus",(()=>{o.value=!0})),l.value.addEventListener("blur",(()=>{o.value=!1})))})),{focused:o}},ae=function t(a){return a instanceof File?{lastModified:(r=a).lastModified,name:r.name,size:r.size,type:r.type}:a instanceof Date?a.toString():Array.isArray(a)?a.map(t):"object"==typeof a&&null!==a?e.mapValues(a,t):a;var r},re=function(t,a,r){var n=r.form$,l=r.el$,o=r.fire,u=r.dirt,s=r.validate,c=r.value;return{initWatcher:()=>{i(c,((t,a)=>{var r,i;r=t,i=a,e.isEqual(ae(r),ae(i))||(o("change",t,a,l.value),u&&u(),s&&n.value.shouldValidateOnChange&&s())}),{immediate:!1,deep:!0})}}},ne={props:{name:{required:!0,type:[String,Number]},conditions:{required:!1,type:[Array],default:()=>[]},onBeforeCreate:{required:!1,type:[Function],default:null,private:!0},onCreated:{required:!1,type:[Function],default:null,private:!0},onBeforeMount:{required:!1,type:[Function],default:null,private:!0},onMounted:{required:!1,type:[Function],default:null,private:!0},onBeforeUpdate:{required:!1,type:[Function],default:null,private:!0},onUpdated:{required:!1,type:[Function],default:null,private:!0},onBeforeUnmount:{required:!1,type:[Function],default:null,private:!0},onUnmounted:{required:!1,type:[Function],default:null,private:!0}}},le={props:{inline:{required:!1,type:[Boolean],default:!1},layout:{required:!1,type:[String,Object,Boolean],default:"ElementLayout",private:!0},addClass:{required:!1,type:[Array,Object,String],default:null},removeClass:{required:!1,type:[Array,Object],default:null},replaceClass:{required:!1,type:[Object],default:null},overrideClass:{required:!1,type:[Array,Object,String],default:null},addClasses:{required:!1,type:[Object],default:()=>({})},replaceClasses:{required:!1,type:[Object],default:()=>({})},removeClasses:{required:!1,type:[Object],default:()=>({})},overrideClasses:{required:!1,type:[Object],default:()=>({})},presets:{required:!1,type:[Array],default:()=>[]},view:{required:!1,type:[String],default:void 0},views:{required:!1,type:[Object],default:()=>({})},size:{required:!1,type:[String],default:void 0},columns:{required:!1,type:[Object,String,Number],default:null},templates:{required:!1,type:[Object],default:()=>({})},description:{required:!1,type:[String,Object],localized:!0,default:null},info:{required:!1,type:[String,Object],localized:!0,default:null},infoPosition:{required:!1,type:[String],default:"right"},label:{required:!1,type:[String,Object,Function],localized:!0,default:null},before:{required:!1,type:[Object,String,Number],localized:!0,default:null},between:{required:!1,type:[Object,String,Number],localized:!0,default:null},after:{required:!1,type:[Object,String,Number],localized:!0,default:null},slots:{required:!1,type:[Object],default:()=>({})}}},oe={props:{onChange:{required:!1,type:[Function],default:null,private:!0}}},ie={props:{formatData:{required:!1,type:[Function],default:null},formatLoad:{required:!1,type:[Function],default:null},submit:{required:!1,type:[Boolean],default:!0}}},ue={props:{rules:{required:!1,type:[Array,String,Object],default:null},messages:{required:!1,type:[Object],default:()=>({})},fieldName:{required:!1,type:[String],"@default":"name|label"}}};function se(a){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!a.name)throw Error("The `name` attribute must be defined to create a new element");var n=a.name,l="".concat(e.upperFirst(e.camelCase(n))),o=["change","beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeUnmount","unmounted"].concat(r.emits||[]);return m({name:l,mixins:[].concat([ne,le,oe,ie,ue]).concat(r.mixins||[]),components:r.components||{},emits:o,setup(e,n){var i=m({},n);i.emits=o,i.name=t(l);var u=function(e,a,r){var n=t(void 0!==r.nullValue?r.nullValue:null);return a.features=[O,j,w,Q,$,U,K,H,I,_,S,x,ee,A,q,R,D,z,k,B,N,J,M,G,te,re],a.slots=["label","info","description","before","between","after"],m({},C(e,a,{deps:{nullValue:n}}))}(e,i,a);i.element=u;var s=r.setup?r.setup(e,i):{};return m(m({},u),s)},props:m({type:{required:!1,type:[String],default:n},default:{required:!1,type:[String,Number,Object],default:void 0},disabled:{required:!1,type:[Boolean],default:!1},floating:{required:!1,type:[String],default:null},id:{required:!1,type:[String],default:null},placeholder:{required:!1,type:[String],default:null}},a.props||{})},e.omit(r,["setup","mixins","emits","props"]))}export{se as default};
